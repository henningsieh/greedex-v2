---
name: "Internationalization (i18n)"
description: "Locale routing, translations, country selection, and multi-language support"
applyTo: "**/i18n/**/*.ts,messages/**/*.json,**/[locale]/**/*.{ts,tsx}"
---

# Internationalization (i18n) Guide

**Context**: When working with locale routing, translations, country selection, or multi-language support.

---

## Comprehensive Documentation

For implementation details, patterns, and examples, **always consult** `/docs/i18n/` first:

- **Next.js with next-intl**: [docs/i18n/next-intl.internationalization.md](../../docs/i18n/next-intl.internationalization.md) — Complete guide to next-intl setup, server/client usage, and message structure
- **File Organization**: [docs/i18n/file-organization.md](../../docs/i18n/file-organization.md) — How i18n files are structured in this project
- **Country Selection Utils**: [docs/i18n/Country-Selection-Utils.md](../../docs/i18n/Country-Selection-Utils.md) — Country selection utilities
- **Dynamic Country Flag Data**: [docs/i18n/Dynamic-Country_Flag-Data.md](../../docs/i18n/Dynamic-Country_Flag-Data.md) — Dynamic country flag data loading
- **EU Countries Configuration**: [docs/i18n/eu-countries-configuration.md](../../docs/i18n/eu-countries-configuration.md) — EU countries configuration

---

## Official Resources

- Official docs: https://next-intl-docs.vercel.app/

---

## Quick Reference

### Server Components

```typescript
import { getTranslations } from "next-intl/server";

export default async function MyServerComponent() {
  const t = await getTranslations("Namespace");

  return <h1>{t("title")}</h1>;
}
```

### Client Components

```typescript
"use client";
import { useTranslations } from "next-intl";

export function MyClientComponent() {
  const t = useTranslations("Namespace");

  return <h1>{t("title")}</h1>;
}
```

### Getting Current Locale

```typescript
// Server Component
import { getLocale } from "next-intl/server";

export default async function MyComponent() {
  const locale = await getLocale();
  return <div>Current locale: {locale}</div>;
}

// Client Component
"use client";
import { useLocale } from "next-intl";

export function MyComponent() {
  const locale = useLocale();
  return <div>Current locale: {locale}</div>;
}
```

---

## Translation File Structure

### Location

```
messages/
├── en/
│   ├── common.json
│   ├── auth.json
│   ├── projects.json
│   └── participate.json
├── de/
│   ├── common.json
│   ├── auth.json
│   ├── projects.json
│   └── participate.json
└── ... (other locales)
```

### Namespace Organization

Each JSON file represents a **namespace** that groups related translations.

**Example**: `messages/en/projects.json`

```json
{
  "title": "Projects",
  "createNew": "Create New Project",
  "list": {
    "empty": "No projects yet",
    "loading": "Loading projects..."
  },
  "form": {
    "nameLabel": "Project Name",
    "namePlaceholder": "Enter project name",
    "descriptionLabel": "Description",
    "submitButton": "Create Project"
  }
}
```

### Using Nested Keys

```typescript
const t = useTranslations("projects");

// Access nested keys with dot notation
t("form.nameLabel"); // "Project Name"
t("list.empty"); // "No projects yet"
```

---

## Common Patterns

### Locale-Based Routing

Routes are automatically prefixed with the locale:

```
/en/projects     → English projects page
/de/projects     → German projects page
/en/auth/login   → English login page
```

**Configuration**: See `src/lib/i18n/config.ts` for supported locales.

### Link with Locale

```typescript
import { Link } from "@/lib/i18n/navigation";

<Link href="/projects">
  {t("navigation.projects")}
</Link>
```

The `Link` component automatically includes the current locale.

### Dynamic Values

```json
{
  "greeting": "Hello, {name}!",
  "itemCount": "You have {count} items"
}
```

```typescript
t("greeting", { name: user.name }); // "Hello, John!"
t("itemCount", { count: items.length }); // "You have 5 items"
```

### Pluralization

```json
{
  "projectCount": {
    "zero": "No projects",
    "one": "One project",
    "other": "{count} projects"
  }
}
```

```typescript
t("projectCount", { count: 0 }); // "No projects"
t("projectCount", { count: 1 }); // "One project"
t("projectCount", { count: 5 }); // "5 projects"
```

### Date & Number Formatting

```typescript
import { useFormatter } from "next-intl";

function MyComponent() {
  const format = useFormatter();

  const date = new Date("2024-01-15");
  const price = 1234.56;

  return (
    <div>
      <p>{format.dateTime(date, { dateStyle: "long" })}</p>
      <p>{format.number(price, { style: "currency", currency: "EUR" })}</p>
    </div>
  );
}
```

---

## Country Selection

### Using Country Selection Utils

```typescript
import { countries } from "@/lib/i18n/countries";

// Get all countries
const allCountries = countries;

// Filter EU countries
const euCountries = countries.filter((c) => c.isEU);

// Get country by code
const germany = countries.find((c) => c.code === "DE");
```

**See**: [docs/i18n/Country-Selection-Utils.md](../../docs/i18n/Country-Selection-Utils.md) for API details.

### Dynamic Flag Loading

```typescript
import { getCountryFlag } from "@/lib/i18n/flags";

const flag = getCountryFlag("DE"); // Returns flag emoji or SVG path
```

**See**: [docs/i18n/Dynamic-Country_Flag-Data.md](../../docs/i18n/Dynamic-Country_Flag-Data.md) for implementation.

---

## Common Tasks

| Task                                    | Implementation                                                                                                                       |
| --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| **Add new translation key**             | Edit `messages/<locale>/<namespace>.json`                                                                                            |
| **Add new locale**                      | 1. Create `messages/<locale>/` folder<br>2. Add locale to `src/lib/i18n/config.ts`<br>3. Copy translation files from existing locale |
| **Use translation in server component** | `const t = await getTranslations("namespace")`                                                                                       |
| **Use translation in client component** | `const t = useTranslations("namespace")`                                                                                             |
| **Format date/number**                  | Use `useFormatter()` hook                                                                                                            |
| **Get current locale**                  | `await getLocale()` (server) or `useLocale()` (client)                                                                               |
| **Link to localized route**             | Use `<Link>` from `@/lib/i18n/navigation`                                                                                            |
| **Select country**                      | Use country selection utils                                                                                                          |

---

## File Locations

| Purpose                           | Location                     |
| --------------------------------- | ---------------------------- |
| **Translation files**             | `messages/<locale>/*.json`   |
| **i18n configuration**            | `src/lib/i18n/config.ts`     |
| **Navigation utilities**          | `src/lib/i18n/navigation.ts` |
| **Country data**                  | `src/lib/i18n/countries.ts`  |
| **Flag utilities**                | `src/lib/i18n/flags.ts`      |
| **Middleware (locale detection)** | `src/middleware.ts`          |

---

## Best Practices

### Keep Translations Flat When Possible

```json
// ✅ Good: Easy to scan
{
  "formNameLabel": "Name",
  "formEmailLabel": "Email",
  "formSubmitButton": "Submit"
}

// ⚠️ Acceptable: Organized but deeper
{
  "form": {
    "name": "Name",
    "email": "Email",
    "submit": "Submit"
  }
}
```

### Use Descriptive Keys

```json
// ✅ Good: Clear intent
{
  "loginFormSubmitButton": "Sign In",
  "registrationFormSubmitButton": "Create Account"
}

// ❌ Avoid: Ambiguous
{
  "button": "Submit",
  "btn": "OK"
}
```

### Avoid Hard-coded Strings

```typescript
// ❌ Avoid: Hard-coded text
<button>Create Project</button>

// ✅ Good: Translated
<button>{t("createProjectButton")}</button>
```

### Test All Locales

Ensure translations exist for all locales. Missing keys will fall back to the default locale or display the key name.

---

## For More Details

- **Comprehensive i18n docs**: `/docs/i18n/`
- **next-intl official docs**: https://next-intl-docs.vercel.app/
- **File organization**: [docs/i18n/file-organization.md](../../docs/i18n/file-organization.md)
